<script type="text/javascript">
$(document).ready(function() {
	$("#my_collection_link img").click(function() {
		// Selected
		$(this).toggleClass('selected-product', true); 
		if ($(this).hasClass('selected-product')) {
			$(this).parents('li').removeClass('not-selected-product');
			$(this).parents('li').siblings().removeClass('selected-product');
			$(this).parents('li').siblings().addClass('not-selected-product');
			$('#my_collection_id').attr('value', $(this).parents('li').attr("id"))
		} else {
			$(this).parents('li').addClass('not-selected-product');			
			//$(this).find('.product_id').attr('value', '')
		}
	});
});
</script>
<%# 
	The following should be using the collections from the current_user rather than the visiting user.
	So that the current_user can add the product to current_user's collections.
%>
<% my_collections = current_user.my_collections %>
<%= form_for MyCollectionItem.new, :as => :my_collection_item, :url => my_collection_items_path, :html => { :id => "do-you-have-one-form", :class => "question-form" } do |f| %>
<div style="width: 800px;">
	<div style="width: 760px; background: #ffffff; margin-left: auto; margin-right: auto; padding: 15px;">
		<h3>Which collection do you want it be?</h3> 
		<div id="question" class="product-grid" style="float: left; margin: 17px; border: 0px; width: 700px;">
			<a id="popupMyCollectionClose" style="cursor: pointer">x</a>
			<ul>
			<% my_collections.each do |my_collection| %>
				<li id="<%= my_collection.id %>" class="not-selected-product" style="margin-right: 10px; margin-bottom: 10px">	
					<%= link_to '#', :id => 'my_collection_link' do %>	
						<% if !my_collection.thumbnail.present? && !my_collection.my_collection_items.nil? && my_collection.my_collection_items.size > 0 %>
							<%#= image_tag(my_collection_items[0].product.thumbnail.url(:small), :class => "preview-image") %>							
							<% if my_collection.my_collection_items[0].product.thumbnail.present? %>
								<%= image_tag( my_collection.my_collection_items[0].product.thumbnail.url(:small), :width => "100", :class => "preview-image", :id => my_collection.id, :title => my_collection.name) %>
							<% elsif  my_collection.my_collection_items[0].product.image_url.present? %>
								<%= image_tag( my_collection.my_collection_items[0].product.image_url, :width => "100", :class => "preview-image", :id => my_collection.id, :title => my_collection.name) %>
							<% else %>
								<%= image_tag "/images/product/no-image_medium.jpg", :size => "100x100", :class => "preview-image", :id => my_collection.id, :title => my_collection.name %>
							<% end %>
						<% else %>
							<%= image_tag my_collection.thumbnail.url(:medium), :size => "100x100", :class => "preview-image", :id => my_collection.id, :title => my_collection.name %>						
						<% end %>
					<% end %>			
					<span>
						<p><%#= simple_format(word_wrap(my_collection.name, :line_width => 10)) %></p>
					</span>						
				</li>		
			<% end %>
			</ul>
				<%= hidden_field_tag 'product_id', product_id %>
				<%= hidden_field_tag 'page_id', 'Product' %>
				<%= hidden_field_tag 'my_collection_id', nil %>
				<%= hidden_field_tag 'interest_indicator', nil %>			
		</div>
		<div style="margin-top: 10px; margin-bottom: 10px; padding-bottom: 10px;">
			<div class="actions">
				<%= f.submit 'Submit', :class => "submit-tip-button" %>
			</div>			
		</div>
	</div>
</div>
<% end %>