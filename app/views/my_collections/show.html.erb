<% title @my_collection.name %>
<script type="text/javascript">  
!function(d,s,id) {
	var js,fjs=d.getElementsByTagName(s)[0];
	if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");

$(document).ready(function() {
    $(document).pngFix(); 
 
	//Default Action
	$(".tab_content").hide(); //Hide all content
	$("ul.tabs li:first").addClass("active").show(); //Activate first tab
	$(".tab_content:first").show(); //Show first tab content
});
</script>
<body class="subpage">
	<!-- FACEBOOK LIKE BUTTON INITIALIZER -->	
		<div id="fb-root"></div>
		<script>(function(d, s, id) {
		  var js, fjs = d.getElementsByTagName(s)[0];
		  if (d.getElementById(id)) return;
		  js = d.createElement(s); js.id = id;
		  js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=<%= FACEBOOK_APP_ID %>";
		  fjs.parentNode.insertBefore(js, fjs);
		}(document, 'script', 'facebook-jssdk'));</script>
	<!-- END OF FACEBOOK LIKE BUTTON INITIALIZER-->	
	
	<div id="grey-strip-signedin">
		<div class="wrapper-top">
			<%= render :partial => 'layouts/navigation', :locals => { :user => @user, :item => "Collections" } %>
		</div>
	</div>
	
	<div class="wrapper-mh">
		<div class="maincol">
	    	<div class="product-item sidebar-content" style="overflow: visible;">		
		        <div class="product-image">		        
					<%#= image_tag @my_collection.thumbnail.url(:medium), :width => "200", :class => "preview-image" %>
					<% if !@my_collection.thumbnail.present? && !@my_collection.my_collection_items.nil? && @my_collection.my_collection_items.size > 0 %>
						<%#= image_tag(my_collection_items[0].product.thumbnail.url(:small), :class => "preview-image") %>							
						<% if @my_collection.my_collection_items[0].product.thumbnail.present? %>
							<%= image_tag( @my_collection.my_collection_items[0].product.thumbnail.url(:medium), :width => "200", :class => "preview-image", :id => @my_collection.id, :title => @my_collection.name) %>
							<% thumbnail_image_path "http://#{HOST}#{@my_collection.my_collection_items[0].product.thumbnail.url(:medium)}" %>			
						<% elsif  @my_collection.my_collection_items[0].product.image_url.present? %>
							<%= image_tag( @my_collection.my_collection_items[0].product.image_url, :width => "200", :class => "preview-image", :id => @my_collection.id, :title => @my_collection.name) %>
							<% thumbnail_image_path @my_collection.my_collection_items[0].product.image_url %>
						<% else %>
							<%= image_tag "/images/product/no-image_medium.jpg", :size => "200x200", :class => "preview-image", :id => @my_collection.id, :title => @my_collection.name %>
							<% thumbnail_image_path "http://#{HOST}/images/product/no-image_medium.jpg" %>			
						<% end %>
					<% else %>
						<%= image_tag @my_collection.thumbnail.url(:medium), :width => "200", :class => "preview-image", :id => @my_collection.id, :title => @my_collection.name %>						
						<% thumbnail_image_path "http://#{HOST}#{@my_collection.thumbnail.url(:medium)}" %>			
					<% end %>
			    </div>
		        <div class="product-detail">
			        <div>
						<p class="left"><h3 style="text-align: left; line-height: 27px;"><%= @my_collection.name %></h3></p>
						<p class="discover">curated by <%= link_to @my_collection.user.full_name, member_path(@my_collection.user.full_name) %></p>
					</div>
					<p><%= @my_collection.description %></p>
				
				<% if user_signed_in? && (@user.present? || current_user.present?) %>						
					<% if @user == current_user %>				
					<p>
						<div id="add_wishlist">
							<%= link_to 'Set the theme', edit_member_my_collection_path(current_user, @my_collection), :class => "button-green round-button", :id => "add-wishlist", :title => "Edit Collection" %>
						</div>	
					</p>
					<% else %>
					<p>					
						<div id="follow-my-collection-<%= @my_collection.id %>">
						<% if @my_collection.following?(current_user) %>
							<%= link_to 'Following', unfollow_my_collection_path(@my_collection, :follower_id => current_user.id), :class => "button-green checked", :id => "own-this", :title => "Unfollow", :remote => true %>
						<% else %>
							<%= link_to 'Follow', follow_my_collection_path(@my_collection, :follower_id => current_user.id), :class => "button-green", :id => "own-this", :title => "Follow", :remote => true %>
						<% end %>
						</div>						
						<div id="response-my-collection-<%= @my_collection.id %>">
						<% if @my_collection.like?(current_user) %>					
							<%= link_to 'Unlike', unlike_my_collection_path(@my_collection, :user_id => current_user.id), :class => "button-green checked", :id => "own-this", :title => "Unlike", :remote => true %>
						<% else %>
							<%= link_to 'Like', like_my_collection_path(@my_collection, :user_id => current_user.id), :class => "button-green", :id => "own-this", :title => "Like", :remote => true %>
						<% end %>
						</div>						
					</p>
					<% end %>					
				<% else %>
					<p>					
						<div id="follow-my-collection-<%= @my_collection.id %>">
							<%= link_to 'Follow', user_session_path, :class => "button-green", :id => "own-this", :title => "Follow", :remote => true %>
						</div>
						<div id="response-my-collection-<%= @my_collection.id %>">
							<%= link_to 'Like', user_session_path, :class => "button-green", :id => "own-this", :title => "Like", :remote => true %>
						</div>
					</p>
				<% end %>
					<br/><br/><br/>			
					<!-- FACEBOOK LIKE AND TWITTER BUTTONS -->
					<div style="margin: 5px;">
						<div style="overflow: visible;" class="fb-like social" data-href="<%= my_collection_url(@my_collection) %>" data-send="false" data-layout="button_count" data-width="90" data-show-faces="false" data-action="recommend" data-font="verdana"></div>
						<a href="https://twitter.com/share" class="twitter-share-button social" data-url="<%= my_collection_url(@my_collection) %>" data-text="Come and see my collection <%= @my_collection.name %> @macabolic. You can also create your own too." data-counturl="<%= my_collection_url(@my_collection) %>" data-via="macabolic" data-count="horizontal" data-lang="en">Tweet</a><script type="text/javascript" src="//platform.twitter.com/widgets.js"></script>
					</div>
					<!-- END OF FACEBOOK LIKE AND TWITTER BUTTONS -->
					<br/>
					
					<div id="my-collection-stat-details" class="product-stat-details" style="float: left; width: 403px;">
						<%= render :partial => "my_collections/my_collection_stat", :locals => { :my_collection => @my_collection } %>
					</div>
		        </div>
			    <br class="clear" />
			</div>			
			
		<% if !@owned_collection_items.empty? %>
			<div class="tabbed-content-area">
				<div class="pagination-wrapper top">
					<div>
						<p style="font-size:14px; color:#808080; padding-left: 23px; text-align:center">
							<strong><span>Own ...</span></strong>
						</p>
					</div>
				</div><!-- .pagination-wrapper -->		
<!--				
				<ul class="tabs"> 
			        <li><a href="#tab1">Collection Items</a></li> 
				</ul> 		
-->
		        <div class="product-grid group"> 
					<%= render :partial => 'my_collection_items/index', :locals => { :my_collection_items => @owned_collection_items, :mode => "read", :filter_my_collection_item => nil } %>
				</div>
				<div class="left"><p class="total"><%= (page_entries_info @owned_collection_items, :entry_name => "collection items").html_safe %></p></div>
				<%# if @my_collection_items.total_pages > 0 %>
				<div class="right">
					<div id="pagination">					
						<%= paginate @owned_collection_items, :param_name => :owned_collection_items_page %>
					</div>
				</div>
				
				<%# end %>				
			</div>
		<% end %>	

		<br>
			
		<% if !@wished_collection_items.empty? %>
			<div class="tabbed-content-area">
				<div class="pagination-wrapper top">
					<div>
						<p style="font-size:14px; color:#808080; padding-left: 23px; text-align:center">
							<strong><span>Wish ...</span></strong>
						</p>
					</div>
				</div><!-- .pagination-wrapper -->		
<!--				
				<ul class="tabs"> 
			        <li><a href="#tab1">Collection Items</a></li> 
				</ul> 		
-->
		    <div class="product-grid group"> 
					<%= render :partial => 'my_collection_items/index', :locals => { :my_collection_items => @wished_collection_items, :mode => "read", :filter_my_collection_item => nil } %>
				</div>
				<div class="left"><p class="total"><%= (page_entries_info @wished_collection_items, :entry_name => "collection items").html_safe %></p></div>
				<%# if @my_collection_items.total_pages > 0 %>
				<div class="right">
					<div id="pagination">
						<%= paginate @wished_collection_items, :param_name => :wished_collection_items_page %>
					</div>
				</div>
				<%# end %>				
			</div>
		<% end %>	

		<br>

    <div class="tabbed-content-area"> 
			<div class="pagination-wrapper top">
				<div>
					<p style="font-size:14px; color:#808080; padding-left: 23px; text-align:center">
						<strong><span>Followers ...</span></strong>
					</p>
				</div>
			</div>
			<ul class="combined-list">
				<li class="grid group">
				<div>
					<% if !@followers.nil? && @followers.size > 0 %>								
						<%= render :partial => 'friendships/followers', :locals => { :followers => @followers } %>
					<% end %>
				</div>
				</li>
			</ul> 
    </div> 
		<br>
		
		<% if @user_other_collection_items.size > 0 %>
			<div class="tabbed-content-area">
				<ul class="tabs"> 
			        <li><a href="#tab1">Also from <%= @my_collection.user.full_name %></a></li> 
				</ul> 		
		        <div class="product-grid group"> 
					<%#= render :partial => 'my_collections/index', :locals => { :my_collections => @user_other_collections, :preview_gallery => false } %>
					<%= render :partial => 'my_collection_items/index', :locals => { :my_collection_items => @user_other_collection_items, :mode => "read", :filter_my_collection_item => nil } %>
				</div>
				<div style="height: 20px; clear: both; float: right; margin-top: 0px; padding-right: 10px; padding-top: 15px;">
					<%= link_to "more", collections_member_path(@my_collection.user) %>	
				</div>				
			</div>
		<% end %>
		</div>

		<div class="sidebar">	
		<% if @user == current_user %>		
			<%= render :partial => 'products/product_search', :locals => { :my_collection => @my_collection } %>
		<% else %>
			<%# Show the list of products that are recommended to you. %>
		<% end %>
		</div>

		<div class="sidebar">			
			<%#= render :partial => 'my_collections/followers_likes', :locals => { :followers => @followers, :responses => @responses } %>
		</div>
				
		<div class="sidebar" id="comment-display">			
			<%= render :partial => 'my_collection_comments/show', :locals => { :my_collection => @my_collection } %>
		</div>
	</div>
</body>