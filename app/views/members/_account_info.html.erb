<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=<%= FACEBOOK_APP_ID %>";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
<div class="sidebar-content account-info">
	<div class="sidebar-header">
    	About <% if @user == current_user %><%= link_to 'Edit', edit_member_path(@user) %><% end %>
	</div>
	<div class="sidebar-inner">					
    	<p class="username">
			<%= image_tag current_profile_image_small_url(@user), :width => "80" %>
    	</p>
    	<p class="username">
    		<strong>Name</strong>
    		<span><%= @user.full_name %></span>
    	</p>
		<% if @user == current_user %>
		<p>
    		<strong>Email</strong>
	  		<%= @user.email %>
		</p>
		<% end %>
		<p>
		    <strong>Birthday</strong>
			<% if @user.birthday.present? %>
		    <%= @user.birthday.strftime("%B %d") %>
			<% else %>
			<%= "N/A" %>
			<% end %>
		</p>	
    <% if user_signed_in? %>
		<% if @user == current_user %>
			<% 
				@facebook_authentication = @user.authentications.find_by_provider('facebook')
				if @facebook_authentication.present? 
			%>
			<p>
				<strong>Facebook</strong>
				<%= link_to "http://wwww.facebook.com/#{@facebook_authentication.uid}/" do %>
					<%= image_tag facebook_profile_image_url(current_user, ProfileImage::FACEBOOK, 'square'), :size => "32x32" %>					
					<%= @facebook_name %>
				<% end %>
			</p>
			<% else %>
			<p>
				<strong>Facebook</strong>
				<%= link_to user_omniauth_authorize_path(:facebook, :type => "connect"), :remote => false do %>			
					<fb:login-button size="large" onlogin="Log.info('onlogin callback')">Connect</fb:login-button>
				<% end %>
			</p>	
			<% end %>
		<% end %>
		<% if @user != current_user %>	
		<p>
			<div id="follow-user-<%= @user.id %>">
			<% if current_user.following?(@user) %>					
				<%= link_to 'unfollow', unfollow_member_friendship_path(current_user, @user), :class => "button-green checked", :id => "own-this", :title => "unfollow", :remote => true %>
			<% else %>
				<%= link_to 'follow', follow_member_friendship_path(current_user, @user), :class => "button-green round-button sidebar-button", :id => "add-wishlist", :title => "follow", :remote => true %>
			<% end %>
			</div>
			<br/>
		</p>
		<% end %>
	<% else %>
		<%= link_to 'follow', user_session_path, :class => "button-green round-button sidebar-button", :id => "add-wishlist", :title => "follow", :remote => false %>
	<% end %>
	</div>

	<div class="sidebar-inner" style="margin-top: 0px">
		<%= render :partial => 'friendships/follow_stat' %>
	</div>
	
</div>
